{% extends 'base.html' %}
{% load static %}

{% block title %}Cumplimiento{% endblock %}

{% block content %}
<h1>Consultas por Periodo</h1>
<select id="periodo-dropdown">
    <option value="">Selecciona un periodo</option>
    {% for periodo in periods %}
        <option value="{{ periodo.id }}">{{ periodo }}</option>
    {% endfor %}
</select>

<div id="consultas-container">
    {% consultas_data %}
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('periodo-dropdown').addEventListener('change', function() {
            var periodoId = this.value;
            if (periodoId) {
                fetch(`/consultas/${periodoId}/`)
                    .then(response => response.json())
                    .then(data => {
                        var consultasContainer = document.getElementById('consultas-container');
                        consultasContainer.innerHTML = '';
                        data.forEach(function(grupo) {
                            var grupoDiv = document.createElement('div');
                            grupoDiv.className = 'grupo-item';
                            grupoDiv.innerHTML = `
                                <h2>Grupo ${grupo.Grupo}</h2>
                                <p><strong>Cuatrimestre:</strong> ${grupo.Cuatrimestre}</p>
                                <p><strong>Periodo:</strong> ${grupo.Periodo}</p>
                            `;
                            consultasContainer.appendChild(grupoDiv);
                        });
                    })
                    .catch(error => console.error('Error al cargar los grupos:', error));
            } else {
                document.getElementById('consultas-container').innerHTML = '';
            }
        });
    });
</script>

<style>
    .grupo-item {
        border: 1px solid #ddd;
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 5px;
    }
    .grupo-item h2 {
        margin: 0 0 5px;
    }
</style>

{% endblock %}
